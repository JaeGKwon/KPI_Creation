[
  {
    "kpi_name": "Unique User Sellers",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT COUNT(DISTINCT user_id) FROM tb_market_seller WHERE user_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:32.346615"
  },
  {
    "kpi_name": "Unique Partner Sellers",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT COUNT(DISTINCT partner_id) FROM tb_market_seller WHERE partner_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:34.566280"
  },
  {
    "kpi_name": "Sellers With Complete Address",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT COUNT(*) FROM tb_market_seller WHERE address IS NOT NULL AND address_detail IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:37.850841"
  },
  {
    "kpi_name": "Top 10 Users by Seller Count",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT user_id, COUNT(*) as count FROM tb_market_seller WHERE user_id IS NOT NULL GROUP BY user_id ORDER BY count DESC LIMIT 10",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:45.720434"
  },
  {
    "kpi_name": "Top 10 Partners by Seller Count",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT partner_id, COUNT(*) as count FROM tb_market_seller WHERE partner_id IS NOT NULL GROUP BY partner_id ORDER BY count DESC LIMIT 10",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:47.474815"
  },
  {
    "kpi_name": "Number of Sellers by Address",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT address, COUNT(*) as count FROM tb_market_seller WHERE address IS NOT NULL GROUP BY address",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:48.855743"
  },
  {
    "kpi_name": "Number of Sellers by Detailed Address",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT address_detail, COUNT(*) as count FROM tb_market_seller WHERE address_detail IS NOT NULL GROUP BY address_detail",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:50.445689"
  },
  {
    "kpi_name": "Number of Sellers Without User or Partner",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT COUNT(*) FROM tb_market_seller WHERE user_id IS NULL AND partner_id IS NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:52.086534"
  },
  {
    "kpi_name": "Number of Sellers With Both User and Partner",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT COUNT(*) FROM tb_market_seller WHERE user_id IS NOT NULL AND partner_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:54.245613"
  },
  {
    "kpi_name": "Number of Sellers With Either User or Partner",
    "table_name": "tb_market_seller",
    "sql_query": "SELECT COUNT(*) FROM tb_market_seller WHERE (user_id IS NOT NULL AND partner_id IS NULL) OR (user_id IS NULL AND partner_id IS NOT NULL)",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:56.068098"
  },
  {
    "kpi_name": "Total Orders",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(*) FROM tb_oem_market_order",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:57.709692"
  },
  {
    "kpi_name": "Total Unique Customers",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(DISTINCT client_info) FROM tb_oem_market_order",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:18:59.545612"
  },
  {
    "kpi_name": "Total Deliveries",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(*) FROM tb_oem_market_order WHERE delivery_info IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:04.158243"
  },
  {
    "kpi_name": "Average Delivery Time",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT AVG(DATEDIFF(delivery_info ->> 'update_date', delivery_info ->> 'create_date')) FROM tb_oem_market_order WHERE delivery_info ->> 'create_date' IS NOT NULL AND delivery_info ->> 'update_date' IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:05.530955"
  },
  {
    "kpi_name": "Total Refunds",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(*) FROM tb_oem_market_order WHERE delivery_info ->> 'is_exchange_refund' = 'true'",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:07.474910"
  },
  {
    "kpi_name": "Refund Rate",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(CASE WHEN delivery_info ->> 'is_exchange_refund' = 'true' THEN 1 END) / COUNT(*) FROM tb_oem_market_order",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:09.486193"
  },
  {
    "kpi_name": "Total Default Deliveries",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(*) FROM tb_oem_market_order WHERE delivery_info ->> 'is_default' = 'true'",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:11.279465"
  },
  {
    "kpi_name": "Average Order Size",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT AVG(delivery_info ->> 'total_cnt') FROM tb_oem_market_order WHERE delivery_info ->> 'total_cnt' IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:12.983210"
  },
  {
    "kpi_name": "Total Unique Delivery Addresses",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(DISTINCT delivery_info ->> 'address') FROM tb_oem_market_order WHERE delivery_info ->> 'address' IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:17.986535"
  },
  {
    "kpi_name": "Total Unique Delivery Names",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(DISTINCT delivery_info ->> 'delivery_name') FROM tb_oem_market_order WHERE delivery_info ->> 'delivery_name' IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:22.490496"
  },
  {
    "kpi_name": "Total Unique Delivery IDs",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(DISTINCT delivery_info ->> 'delivery_id') FROM tb_oem_market_order WHERE delivery_info ->> 'delivery_id' IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:23.924581"
  },
  {
    "kpi_name": "Total Unique User IDs",
    "table_name": "tb_oem_market_order",
    "sql_query": "SELECT COUNT(DISTINCT delivery_info ->> 'user_id') FROM tb_oem_market_order WHERE delivery_info ->> 'user_id' IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:25.688972"
  },
  {
    "kpi_name": "Total Subscriptions",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT COUNT(*) FROM tb_subscribe_partner WHERE is_active = true",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:27.207668"
  },
  {
    "kpi_name": "Total Active Subscriptions",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT COUNT(*) FROM tb_subscribe_partner WHERE is_active = true AND end_date IS NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:28.837061"
  },
  {
    "kpi_name": "Total Inactive Subscriptions",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT COUNT(*) FROM tb_subscribe_partner WHERE is_active = false OR end_date IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:30.364243"
  },
  {
    "kpi_name": "Subscription Duration",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT AVG(DATEDIFF(end_date, start_date)) FROM tb_subscribe_partner WHERE end_date IS NOT NULL AND start_date IS NOT NULL AND end_date > start_date",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:32.395063"
  },
  {
    "kpi_name": "Subscriptions by Partner",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT partner_id, COUNT(*) FROM tb_subscribe_partner GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:33.809807"
  },
  {
    "kpi_name": "Active Subscriptions by Partner",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT partner_id, COUNT(*) FROM tb_subscribe_partner WHERE is_active = true AND end_date IS NULL GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:35.511963"
  },
  {
    "kpi_name": "Inactive Subscriptions by Partner",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT partner_id, COUNT(*) FROM tb_subscribe_partner WHERE is_active = false OR end_date IS NOT NULL GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:37.195745"
  },
  {
    "kpi_name": "Subscriptions by Plan",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT plan_id, COUNT(*) FROM tb_subscribe_partner GROUP BY plan_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:38.763297"
  },
  {
    "kpi_name": "Active Subscriptions by Plan",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT plan_id, COUNT(*) FROM tb_subscribe_partner WHERE is_active = true AND end_date IS NULL GROUP BY plan_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:40.509157"
  },
  {
    "kpi_name": "Inactive Subscriptions by Plan",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT plan_id, COUNT(*) FROM tb_subscribe_partner WHERE is_active = false OR end_date IS NOT NULL GROUP BY plan_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:42.220448"
  },
  {
    "kpi_name": "Subscriptions by Fee",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT fee_id, COUNT(*) FROM tb_subscribe_partner GROUP BY fee_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:44.216690"
  },
  {
    "kpi_name": "Active Subscriptions by Fee",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT fee_id, COUNT(*) FROM tb_subscribe_partner WHERE is_active = true AND end_date IS NULL GROUP BY fee_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:46.018514"
  },
  {
    "kpi_name": "Inactive Subscriptions by Fee",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT fee_id, COUNT(*) FROM tb_subscribe_partner WHERE is_active = false OR end_date IS NOT NULL GROUP BY fee_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:47.659851"
  },
  {
    "kpi_name": "Subscriptions by Super User Type",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT super_user_type, COUNT(*) FROM tb_subscribe_partner GROUP BY super_user_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:49.186465"
  },
  {
    "kpi_name": "Active Subscriptions by Super User Type",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT super_user_type, COUNT(*) FROM tb_subscribe_partner WHERE is_active = true AND end_date IS NULL GROUP BY super_user_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:50.671663"
  },
  {
    "kpi_name": "Inactive Subscriptions by Super User Type",
    "table_name": "tb_subscribe_partner",
    "sql_query": "SELECT super_user_type, COUNT(*) FROM tb_subscribe_partner WHERE is_active = false OR end_date IS NOT NULL GROUP BY super_user_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:52.152340"
  },
  {
    "kpi_name": "Total Factories",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT COUNT(*) FROM tb_sales_factory WHERE factory_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:54.178775"
  },
  {
    "kpi_name": "Factories by Region",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT region, COUNT(*) FROM tb_sales_factory WHERE region IS NOT NULL GROUP BY region",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:55.833668"
  },
  {
    "kpi_name": "Factories by Industrial Complex",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT industrial_complex, COUNT(*) FROM tb_sales_factory WHERE industrial_complex IS NOT NULL GROUP BY industrial_complex",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:57.684013"
  },
  {
    "kpi_name": "Factories by Corporation Type",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT corporation_type, COUNT(*) FROM tb_sales_factory WHERE corporation_type IS NOT NULL GROUP BY corporation_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:19:59.738883"
  },
  {
    "kpi_name": "Factories by Business Type",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT business_type, COUNT(*) FROM tb_sales_factory WHERE business_type IS NOT NULL GROUP BY business_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:01.948786"
  },
  {
    "kpi_name": "Factories by Size",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT factory_size, COUNT(*) FROM tb_sales_factory WHERE factory_size IS NOT NULL GROUP BY factory_size",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:05.516648"
  },
  {
    "kpi_name": "Factories with Contact Information",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT COUNT(*) FROM tb_sales_factory WHERE contact_cellphone IS NOT NULL OR factory_cellphone IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:08.063953"
  },
  {
    "kpi_name": "Factories with Representative Information",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT COUNT(*) FROM tb_sales_factory WHERE representative_name IS NOT NULL AND representative_cellphone IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:09.929573"
  },
  {
    "kpi_name": "Factories by Area",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT area, COUNT(*) FROM tb_sales_factory WHERE area IS NOT NULL GROUP BY area",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:13.477802"
  },
  {
    "kpi_name": "Factories with Complete Address",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT COUNT(*) FROM tb_sales_factory WHERE factory_street_address IS NOT NULL AND factory_lot_address IS NOT NULL AND factory_zip_code IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:15.182460"
  },
  {
    "kpi_name": "Factories by Company Name",
    "table_name": "tb_sales_factory",
    "sql_query": "SELECT company_name, COUNT(*) FROM tb_sales_factory WHERE company_name IS NOT NULL GROUP BY company_name",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:17.456255"
  },
  {
    "kpi_name": "Total Service Types",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE service_type_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:20.212265"
  },
  {
    "kpi_name": "Visible Service Types",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE is_visible = true",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:21.854747"
  },
  {
    "kpi_name": "Service Types Requiring File",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE file_required = '10' OR file_required = '11'",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:23.357326"
  },
  {
    "kpi_name": "Service Types Not Requiring File",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE file_required = '01'",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:24.794090"
  },
  {
    "kpi_name": "Open Service Types",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE display_status = 1",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:26.497577"
  },
  {
    "kpi_name": "New Service Types",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE display_status = 2",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:28.455542"
  },
  {
    "kpi_name": "Hidden Service Types",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE display_status = 4",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:30.346540"
  },
  {
    "kpi_name": "Deleted Service Types",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE display_status = 5",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:32.497993"
  },
  {
    "kpi_name": "Service Types With Images",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE service_image_path IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:34.224961"
  },
  {
    "kpi_name": "Service Types Without Parent",
    "table_name": "tb_type_service",
    "sql_query": "SELECT COUNT(*) FROM tb_type_service WHERE parent_service_type_id IS NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:38.697236"
  },
  {
    "kpi_name": "Service Types By Root Type",
    "table_name": "tb_type_service",
    "sql_query": "SELECT root_service_type, COUNT(*) FROM tb_type_service GROUP BY root_service_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:42.672320"
  },
  {
    "kpi_name": "Total Number of Payment Methods",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT COUNT(*) FROM tb_payment_method WHERE method_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:44.764519"
  },
  {
    "kpi_name": "Number of Active Payment Methods",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT COUNT(*) FROM tb_payment_method WHERE status = 1",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:46.463433"
  },
  {
    "kpi_name": "Number of Deleted Payment Methods",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT COUNT(*) FROM tb_payment_method WHERE status = 2",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:48.417684"
  },
  {
    "kpi_name": "Number of Personal Cards",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT COUNT(*) FROM tb_payment_method WHERE card_owner_type = 1",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:50.450735"
  },
  {
    "kpi_name": "Number of Corporate Cards",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT COUNT(*) FROM tb_payment_method WHERE card_owner_type = 2",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:51.883636"
  },
  {
    "kpi_name": "Number of Payment Methods by Partner",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT partner_id, COUNT(*) FROM tb_payment_method GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:53.432141"
  },
  {
    "kpi_name": "Number of Payment Methods by User",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT user_id, COUNT(*) FROM tb_payment_method GROUP BY user_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:55.076155"
  },
  {
    "kpi_name": "Number of Payment Methods by Type",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT method_type, COUNT(*) FROM tb_payment_method GROUP BY method_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:57.127491"
  },
  {
    "kpi_name": "Number of New Payment Methods per Month",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT DATE_TRUNC('month', create_date) AS month, COUNT(*) FROM tb_payment_method WHERE create_date IS NOT NULL GROUP BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:20:59.659608"
  },
  {
    "kpi_name": "Number of Deleted Payment Methods per Month",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT DATE_TRUNC('month', create_date) AS month, COUNT(*) FROM tb_payment_method WHERE status = 2 AND create_date IS NOT NULL GROUP BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:01.419257"
  },
  {
    "kpi_name": "Number of Active Payment Methods per Partner",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT partner_id, COUNT(*) FROM tb_payment_method WHERE status = 1 GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:03.276203"
  },
  {
    "kpi_name": "Number of Active Payment Methods per User",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT user_id, COUNT(*) FROM tb_payment_method WHERE status = 1 GROUP BY user_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:04.849167"
  },
  {
    "kpi_name": "Number of Active Personal Cards per User",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT user_id, COUNT(*) FROM tb_payment_method WHERE status = 1 AND card_owner_type = 1 GROUP BY user_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:06.590853"
  },
  {
    "kpi_name": "Number of Active Corporate Cards per Partner",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT partner_id, COUNT(*) FROM tb_payment_method WHERE status = 1 AND card_owner_type = 2 GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:07.931602"
  },
  {
    "kpi_name": "Number of Active Payment Methods by Type per Month",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT DATE_TRUNC('month', create_date) AS month, method_type, COUNT(*) FROM tb_payment_method WHERE status = 1 AND create_date IS NOT NULL GROUP BY month, method_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:09.680120"
  },
  {
    "kpi_name": "Number of Deleted Payment Methods by Type per Month",
    "table_name": "tb_payment_method",
    "sql_query": "SELECT DATE_TRUNC('month', create_date) AS month, method_type, COUNT(*) FROM tb_payment_method WHERE status = 2 AND create_date IS NOT NULL GROUP BY month, method_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:12.256072"
  },
  {
    "kpi_name": "Total Cart Items",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT COUNT(*) FROM tb_market_cart WHERE cnt IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:13.702776"
  },
  {
    "kpi_name": "Unique Products in Carts",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT COUNT(DISTINCT product_id) FROM tb_market_cart WHERE product_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:15.456081"
  },
  {
    "kpi_name": "Average Cart Size",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT AVG(cnt) FROM tb_market_cart WHERE cnt IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:17.710785"
  },
  {
    "kpi_name": "Cart Creation Rate",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT COUNT(*) / COUNT(DISTINCT DATE(create_date)) FROM tb_market_cart WHERE create_date IS NOT NULL AND create_date > '1900-01-01'",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:19.572253"
  },
  {
    "kpi_name": "Product Popularity",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT product_id, COUNT(*) FROM tb_market_cart WHERE product_id IS NOT NULL GROUP BY product_id ORDER BY COUNT(*) DESC",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:21.448830"
  },
  {
    "kpi_name": "User Cart Activity",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT user_id, COUNT(*) FROM tb_market_cart WHERE user_id IS NOT NULL GROUP BY user_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:22.894641"
  },
  {
    "kpi_name": "Cart Conversion Rate",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT COUNT(CASE WHEN status = 'completed' THEN 1 END) / COUNT(*) FROM tb_market_cart WHERE status IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:28.858502"
  },
  {
    "kpi_name": "Cart Abandonment Rate",
    "table_name": "tb_market_cart",
    "sql_query": "SELECT COUNT(CASE WHEN status = 'abandoned' THEN 1 END) / COUNT(*) FROM tb_market_cart WHERE status IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-25T00:21:30.647247"
  }
]