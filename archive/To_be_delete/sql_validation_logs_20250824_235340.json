[
  {
    "kpi_name": "Total Sales by User",
    "table_name": "tb_market_order",
    "sql_query": "SELECT user_id, SUM(payment_total) FROM tb_market_order WHERE user_id IS NOT NULL AND payment_total IS NOT NULL GROUP BY user_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:22.864648"
  },
  {
    "kpi_name": "Total Sales by Partner",
    "table_name": "tb_market_order",
    "sql_query": "SELECT partner_id, SUM(payment_total) FROM tb_market_order WHERE partner_id IS NOT NULL AND payment_total IS NOT NULL GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:24.850676"
  },
  {
    "kpi_name": "Total Sales by Status",
    "table_name": "tb_market_order",
    "sql_query": "SELECT status, SUM(payment_total) FROM tb_market_order WHERE status IS NOT NULL AND payment_total IS NOT NULL GROUP BY status",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:26.737440"
  },
  {
    "kpi_name": "Average Order Value by User",
    "table_name": "tb_market_order",
    "sql_query": "SELECT user_id, AVG(payment_total) FROM tb_market_order WHERE user_id IS NOT NULL AND payment_total IS NOT NULL GROUP BY user_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:28.863427"
  },
  {
    "kpi_name": "Average Order Value by Partner",
    "table_name": "tb_market_order",
    "sql_query": "SELECT partner_id, AVG(payment_total) FROM tb_market_order WHERE partner_id IS NOT NULL AND payment_total IS NOT NULL GROUP BY partner_id",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:31.107055"
  },
  {
    "kpi_name": "Average Order Value by Status",
    "table_name": "tb_market_order",
    "sql_query": "SELECT status, AVG(payment_total) FROM tb_market_order WHERE status IS NOT NULL AND payment_total IS NOT NULL GROUP BY status",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:33.103261"
  },
  {
    "kpi_name": "Total Orders by Order Type",
    "table_name": "tb_market_order",
    "sql_query": "SELECT order_type, COUNT(order_id) FROM tb_market_order WHERE order_type IS NOT NULL GROUP BY order_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:34.263672"
  },
  {
    "kpi_name": "Total Sales by Order Type",
    "table_name": "tb_market_order",
    "sql_query": "SELECT order_type, SUM(payment_total) FROM tb_market_order WHERE order_type IS NOT NULL AND payment_total IS NOT NULL GROUP BY order_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:36.295001"
  },
  {
    "kpi_name": "Average Order Value by Order Type",
    "table_name": "tb_market_order",
    "sql_query": "SELECT order_type, AVG(payment_total) FROM tb_market_order WHERE order_type IS NOT NULL AND payment_total IS NOT NULL GROUP BY order_type",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:38.044092"
  },
  {
    "kpi_name": "Total Test Orders",
    "table_name": "tb_market_order",
    "sql_query": "SELECT COUNT(order_id) FROM tb_market_order WHERE is_test = TRUE",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:40.422824"
  },
  {
    "kpi_name": "Total Users",
    "table_name": "tb_user",
    "sql_query": "SELECT COUNT(DISTINCT user_id) FROM tb_user WHERE user_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:42.356820"
  },
  {
    "kpi_name": "Daily Active Users",
    "table_name": "tb_user",
    "sql_query": "SELECT log_date, COUNT(DISTINCT user_id) FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY log_date",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:44.887106"
  },
  {
    "kpi_name": "Monthly Active Users",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('month', log_date) AS month, COUNT(DISTINCT user_id) FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:46.630916"
  },
  {
    "kpi_name": "Yearly Active Users",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('year', log_date) AS year, COUNT(DISTINCT user_id) FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY year",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:48.497136"
  },
  {
    "kpi_name": "User Growth Rate",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('month', log_date) AS month, COUNT(DISTINCT user_id) - LAG(COUNT(DISTINCT user_id), 1) OVER (ORDER BY month) AS growth_rate FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:50.772748"
  },
  {
    "kpi_name": "User Churn Rate",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('month', log_date) AS month, COUNT(DISTINCT user_id) - LEAD(COUNT(DISTINCT user_id), 1) OVER (ORDER BY month) AS churn_rate FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:52.486026"
  },
  {
    "kpi_name": "User Retention Rate",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('month', log_date) AS month, COUNT(DISTINCT user_id) / LAG(COUNT(DISTINCT user_id), 1) OVER (ORDER BY month) AS retention_rate FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:54.061391"
  },
  {
    "kpi_name": "Average User Activity per Day",
    "table_name": "tb_user",
    "sql_query": "SELECT log_date, COUNT(*) / COUNT(DISTINCT user_id) AS avg_activity FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY log_date",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:52:59.107732"
  },
  {
    "kpi_name": "Average User Activity per Month",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('month', log_date) AS month, COUNT(*) / COUNT(DISTINCT user_id) AS avg_activity FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:01.300268"
  },
  {
    "kpi_name": "Average User Activity per Year",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('year', log_date) AS year, COUNT(*) / COUNT(DISTINCT user_id) AS avg_activity FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY year",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:03.037365"
  },
  {
    "kpi_name": "Peak User Activity Day",
    "table_name": "tb_user",
    "sql_query": "SELECT log_date, COUNT(*) AS activity FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY log_date ORDER BY activity DESC LIMIT 1",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:04.814370"
  },
  {
    "kpi_name": "Peak User Activity Month",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('month', log_date) AS month, COUNT(*) AS activity FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY month ORDER BY activity DESC LIMIT 1",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:06.779694"
  },
  {
    "kpi_name": "Peak User Activity Year",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('year', log_date) AS year, COUNT(*) AS activity FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY year ORDER BY activity DESC LIMIT 1",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:08.893709"
  },
  {
    "kpi_name": "User Activity Trend",
    "table_name": "tb_user",
    "sql_query": "SELECT DATE_TRUNC('month', log_date) AS month, COUNT(*) AS activity FROM tb_user WHERE log_date IS NOT NULL AND user_id IS NOT NULL GROUP BY month ORDER BY month",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:11.207142"
  },
  {
    "kpi_name": "Total Transactions",
    "table_name": "tb_payment",
    "sql_query": "SELECT COUNT(*) FROM tb_payment WHERE transaction_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:13.480397"
  },
  {
    "kpi_name": "Total Revenue",
    "table_name": "tb_payment",
    "sql_query": "SELECT SUM(total_amount) FROM tb_payment WHERE total_amount IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:16.238329"
  },
  {
    "kpi_name": "Average Transaction Value",
    "table_name": "tb_payment",
    "sql_query": "SELECT AVG(total_amount) FROM tb_payment WHERE total_amount IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:17.838709"
  },
  {
    "kpi_name": "Total Commission",
    "table_name": "tb_payment",
    "sql_query": "SELECT SUM(commission) FROM tb_payment WHERE commission IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:19.904353"
  },
  {
    "kpi_name": "Average Commission per Transaction",
    "table_name": "tb_payment",
    "sql_query": "SELECT AVG(commission) FROM tb_payment WHERE commission IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:21.366877"
  },
  {
    "kpi_name": "Total Delivery Cost",
    "table_name": "tb_payment",
    "sql_query": "SELECT SUM(delivery_cost) FROM tb_payment WHERE delivery_cost IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:23.556684"
  },
  {
    "kpi_name": "Average Delivery Cost per Transaction",
    "table_name": "tb_payment",
    "sql_query": "SELECT AVG(delivery_cost) FROM tb_payment WHERE delivery_cost IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:25.604761"
  },
  {
    "kpi_name": "Total Users",
    "table_name": "tb_payment",
    "sql_query": "SELECT COUNT(DISTINCT user_id) FROM tb_payment WHERE user_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:27.324907"
  },
  {
    "kpi_name": "Total Partners",
    "table_name": "tb_payment",
    "sql_query": "SELECT COUNT(DISTINCT partner_id) FROM tb_payment WHERE partner_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:29.081272"
  },
  {
    "kpi_name": "Average Transactions per User",
    "table_name": "tb_payment",
    "sql_query": "SELECT COUNT(*)/COUNT(DISTINCT user_id) FROM tb_payment WHERE user_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:31.725926"
  },
  {
    "kpi_name": "Average Transactions per Partner",
    "table_name": "tb_payment",
    "sql_query": "SELECT COUNT(*)/COUNT(DISTINCT partner_id) FROM tb_payment WHERE partner_id IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:33.564355"
  },
  {
    "kpi_name": "Total Unique Cards Used",
    "table_name": "tb_payment",
    "sql_query": "SELECT COUNT(DISTINCT card_info ->> 'card_number') FROM tb_payment WHERE card_info ->> 'card_number' IS NOT NULL",
    "issues": [],
    "status": "passed",
    "timestamp": "2025-08-24T23:53:36.608963"
  }
]